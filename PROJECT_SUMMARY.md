# AI Agent MVP é¡¹ç›®æ€»ç»“

## ğŸ¯ é¡¹ç›®æ¦‚è¿°

æˆåŠŸå®ç°äº†åŸºäº LangGraph çš„ 6 èŠ‚ç‚¹ AI Agent å·¥ä½œæµï¼Œèƒ½å¤Ÿå°†é£ä¹¦æ–‡æ¡£ URL è½¬æ¢ä¸ºä½ä»£ç å·¥ä½œæµç”Ÿæˆã€‚

## âœ… å®Œæˆçš„åŠŸèƒ½

### 1. æ ¸å¿ƒå·¥ä½œæµæ¶æ„
```
ingest_input â†’ fetch_feishu_doc â†’ understand_doc_parallel
â†’ normalize_and_validate_ism â†’ plan_from_ism â†’ apply_flow_patch â†’ finalize
```

### 2. å·²å®ç°çš„ç»„ä»¶

#### çŠ¶æ€ç®¡ç† (models/state.py)
- AgentState TypedDict å®šä¹‰
- ä¸¥æ ¼çš„å­—æ®µå†™å…¥æƒé™æ§åˆ¶
- å®Œæ•´çš„çŠ¶æ€æµè½¬æ”¯æŒ

#### æ—¥å¿—ç³»ç»Ÿ (utils/logger.py)
- ç»“æ„åŒ– JSON æ—¥å¿—
- trace_id è¿½è¸ª
- æ”¯æŒå¤šçº§åˆ«æ—¥å¿—

#### å·¥ä½œæµèŠ‚ç‚¹
1. **ingest_input**: è¾“å…¥éªŒè¯å’Œæ ‡å‡†åŒ–
2. **fetch_feishu_doc**: é£ä¹¦æ–‡æ¡£è·å–ï¼ˆæ”¯æŒ Mock é™çº§ï¼‰
3. **understand_doc_parallel**: å¹¶è¡Œæ–‡æ¡£ç†è§£ï¼Œç”Ÿæˆ ISM
4. **normalize_and_validate_ism**: ISM æ ‡å‡†åŒ–å’ŒéªŒè¯
5. **plan_from_ism**: ä» ISM ç”Ÿæˆæ‰§è¡Œè®¡åˆ’
6. **apply_flow_patch**: æµç¨‹åˆæˆå’Œ MCP è½½è·ç”Ÿæˆ
7. **finalize**: ç»“æœæ•´ç†å’Œå“åº”æ ¼å¼åŒ–

#### ä¸»å·¥ä½œæµå…¥å£ (app.py)
- LangGraph å›¾é…ç½®
- å®Œæ•´çš„å·¥ä½œæµç¼–æ’
- æµ‹è¯•ç”¨ä¾‹æ”¯æŒ

#### API æœåŠ¡å™¨ (server.py)
- FastAPI REST API
- Thread/Run æ¨¡å¼
- CORS æ”¯æŒ

#### å·¥å…·å’Œé›†æˆ
- **é£ä¹¦å®¢æˆ·ç«¯**: çœŸå® API + Mock é™çº§
- **DeepSeek å®¢æˆ·ç«¯**: LLM é›†æˆ
- **Mock MCP å®¢æˆ·ç«¯**: æ¨¡æ‹Ÿ MCP æœåŠ¡

### 3. é…ç½®ç®¡ç†
- ç¯å¢ƒå˜é‡é…ç½® (.env)
- çµæ´»çš„é™çº§ç­–ç•¥
- æ”¯æŒçœŸå® API å’Œ Mock æ¨¡å¼

## ğŸ§ª æµ‹è¯•ç»“æœ

### å·¥ä½œæµæµ‹è¯•
```
âœ… æ‰€æœ‰ 6 ä¸ªèŠ‚ç‚¹æ‰§è¡ŒæˆåŠŸ
âœ… çŠ¶æ€æµè½¬æ­£å¸¸
âœ… æ—¥å¿—è®°å½•å®Œæ•´
âœ… MCP è½½è·ç”ŸæˆæˆåŠŸ
âœ… Mock MCP å®¢æˆ·ç«¯å“åº”æ­£å¸¸
```

### API æµ‹è¯•
```
âœ… FastAPI æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ
âœ… æ ¹è·¯å¾„è®¿é—®æ­£å¸¸
âœ… Thread åˆ›å»ºæˆåŠŸ
âœ… å·¥ä½œæµ API è°ƒç”¨æˆåŠŸ
```

## ğŸ“Š æ ¸å¿ƒæŒ‡æ ‡

- **å·¥ä½œæµèŠ‚ç‚¹**: 6ä¸ª âœ…
- **API æ¥å£**: 3ä¸ª âœ…
- **Mock é™çº§**: æ”¯æŒ âœ…
- **æ—¥å¿—è¿½è¸ª**: trace_id âœ…
- **çŠ¶æ€ç®¡ç†**: ä¸¥æ ¼æƒé™ âœ…
- **é”™è¯¯å¤„ç†**: ä¼˜é›…é™çº§ âœ…

## ğŸ”§ æŠ€æœ¯æ ˆ

- **Python**: 3.10+
- **LangGraph**: 1.0.2+ (å·¥ä½œæµç¼–æ’)
- **FastAPI**: 0.120.4+ (REST API)
- **LangSmith**: 0.4.39+ (ç›‘æ§è¿½è¸ª)
- **DeepSeek**: LLM é›†æˆ
- **é£ä¹¦ API**: æ–‡æ¡£è·å–

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### 1. LangGraph Studio è°ƒè¯•
```bash
uv run langgraph dev --port 8123
# è®¿é—®: https://smith.langchain.com/studio/?baseUrl=http://127.0.0.1:8123
```

### 2. API æœåŠ¡å™¨è¿è¡Œ
```bash
uv run python server.py
# è®¿é—®: http://localhost:8123
```

### 3. ç›´æ¥å·¥ä½œæµæµ‹è¯•
```bash
uv run python app.py
```

### 4. API æµ‹è¯•
```bash
uv run python test_api.py
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
ai-agent-mvp/
â”œâ”€â”€ app.py                    # âœ… ä¸»å·¥ä½œæµå…¥å£
â”œâ”€â”€ studio_app.py             # âœ… LangGraph Studio é…ç½®
â”œâ”€â”€ server.py                 # âœ… FastAPI REST API æœåŠ¡å™¨
â”œâ”€â”€ config.py                 # âœ… åº”ç”¨é…ç½®
â”œâ”€â”€ test_api.py              # âœ… API æµ‹è¯•è„šæœ¬
â”œâ”€â”€ models/
â”‚   â””â”€â”€ state.py              # âœ… AgentState å®šä¹‰
â”œâ”€â”€ nodes/                    # âœ… 6ä¸ªå·¥ä½œæµèŠ‚ç‚¹
â”‚   â”œâ”€â”€ ingest_input.py
â”‚   â”œâ”€â”€ fetch_feishu_doc.py
â”‚   â”œâ”€â”€ understand_doc_parallel.py
â”‚   â”œâ”€â”€ normalize_and_validate_ism.py
â”‚   â”œâ”€â”€ plan_from_ism.py
â”‚   â”œâ”€â”€ apply_flow_patch.py
â”‚   â””â”€â”€ finalize.py
â”œâ”€â”€ utils/
â”‚   â””â”€â”€ logger.py             # âœ… ç»“æ„åŒ–æ—¥å¿—
â”œâ”€â”€ mock/
â”‚   â””â”€â”€ mcp_client.py        # âœ… Mock MCP å®¢æˆ·ç«¯
â””â”€â”€ å¤–éƒ¨å®¢æˆ·ç«¯
    â”œâ”€â”€ feishu_client.py     # âœ… é£ä¹¦å®¢æˆ·ç«¯
    â””â”€â”€ deepseek_client.py   # âœ… DeepSeek å®¢æˆ·ç«¯
```

## ğŸ‰ æˆåŠŸè¾“å‡ºç¤ºä¾‹

å·¥ä½œæµæˆåŠŸè¿è¡Œåä¼šç”Ÿæˆï¼š

```json
{
  "trace_id": "test-001",
  "status": "success",
  "ism": {
    "interfaces": [
      {
        "id": "users_crud",
        "name": "ç”¨æˆ·ç®¡ç†CRUD",
        "type": "crud",
        "fields": [...]
      }
    ]
  },
  "plan": [...],
  "mcp_execution": {
    "success_rate": "100.0%",
    "results": [...]
  }
}
```

## ğŸ”„ æ‰©å±•æ–¹å‘

1. **RAG é›†æˆ**: åœ¨æ–‡æ¡£è·å–å’Œç†è§£ä¹‹é—´æ’å…¥
2. **ç¼“å­˜å±‚**: æ–‡æ¡£çº§ç¼“å­˜ä¼˜åŒ–
3. **æ›´å¤š LLM**: æ”¯æŒå¤šç§ LLM æä¾›å•†
4. **çœŸå® MCP**: æ›¿æ¢ Mock ä¸ºçœŸå® MCP æœåŠ¡
5. **é«˜çº§è§£æ**: æ›´å¤æ‚çš„æ–‡æ¡£ç»“æ„è§£æ

## âœ¨ é¡¹ç›®äº®ç‚¹

- **å®Œæ•´çš„å·¥ä½œæµ**: 6 èŠ‚ç‚¹ LangGraph å®ç°
- **ä¼˜é›…é™çº§**: API å¤±è´¥æ—¶è‡ªåŠ¨é™çº§åˆ° Mock
- **ç»“æ„åŒ–æ—¥å¿—**: å®Œæ•´çš„ trace_id è¿½è¸ª
- **ç±»å‹å®‰å…¨**: TypedDict çŠ¶æ€ç®¡ç†
- **æµ‹è¯•å‹å¥½**: å®Œæ•´çš„æµ‹è¯•è„šæœ¬å’Œ Mock æ”¯æŒ

**ğŸš€ é¡¹ç›®å·²å®Œå…¨å¯ç”¨ï¼Œæ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½æ­£å¸¸è¿è¡Œï¼**